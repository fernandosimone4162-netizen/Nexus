<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Nexus - Gestão</title>
<style>
body { font-family: Arial; background:#f4f4f4; padding:20px }
h2 { margin-top:40px }
.box { background:#fff; padding:15px; border-radius:8px; margin-bottom:20px }
input, select, button { margin:5px; padding:6px }
table { width:100%; border-collapse:collapse; margin-top:10px }
th, td { border:1px solid #ccc; padding:6px; text-align:center }
.total { font-weight:bold; font-size:18px }
</style>
</head>

<body>

<h1>Nexus — Sistema de Gestão</h1>

<!-- ================= VENDAS ================= -->
<div class="box">
<h2>Venda</h2>

<input id="v_nome" placeholder="Produto">
<input id="v_qtd" type="number" placeholder="Qtd">
<select id="v_unidade">
  <option>unidade</option>
  <option>kg</option>
  <option>g</option>
  <option>litro</option>
  <option>ml</option>
</select>
<input id="v_preco" type="number" placeholder="Preço unitário">

<button onclick="addVendaItem()">Adicionar item</button>

<table id="v_table">
<tr><th>Produto</th><th>Qtd</th><th>Unidade</th><th>Preço</th><th>Total</th></tr>
</table>

<br>
Ajuste R$: <input id="v_ajuste_valor" type="number" value="0">
Ajuste %: <input id="v_ajuste_pct" type="number" value="0">
Volume %: <input id="v_volume_pct" type="number" value="0">

<p class="total">Total Venda: R$ <span id="v_total">0.00</span></p>

<button onclick="finalizarVenda()">Finalizar Venda</button>
</div>

<!-- ================= COMPRAS ================= -->
<div class="box">
<h2>Compra / Fornecedor</h2>

<input id="c_nome" placeholder="Produto">
<input id="c_qtd" type="number" placeholder="Qtd">
<select id="c_unidade">
  <option>unidade</option>
  <option>kg</option>
  <option>g</option>
  <option>litro</option>
  <option>ml</option>
</select>
<input id="c_preco" type="number" placeholder="Preço unitário">

<button onclick="addCompra()">Registrar Compra</button>
</div>

<!-- ================= HISTÓRICOS ================= -->
<div class="box">
<h2>Histórico de Vendas</h2>
<div id="hist_vendas"></div>
</div>

<div class="box">
<h2>Histórico de Compras</h2>
<div id="hist_compras"></div>
</div>

<script>
let vendaItens = [];

function addVendaItem(){
  let nome = v_nome.value;
  let qtd = parseFloat(v_qtd.value);
  let unidade = v_unidade.value;
  let preco = parseFloat(v_preco.value);

  if(!nome || !qtd || !preco) return alert("Preencha tudo");

  vendaItens.push({nome,qtd,unidade,preco});
  renderVenda();
}

function renderVenda(){
  v_table.innerHTML = "<tr><th>Produto</th><th>Qtd</th><th>Unidade</th><th>Preço</th><th>Total</th></tr>";
  let total = 0;

  vendaItens.forEach(i=>{
    let itemTotal = i.qtd * i.preco;
    total += itemTotal;
    v_table.innerHTML += `<tr>
      <td>${i.nome}</td>
      <td>${i.qtd}</td>
      <td>${i.unidade}</td>
      <td>R$ ${i.preco}</td>
      <td>R$ ${itemTotal.toFixed(2)}</td>
    </tr>`;
  });

  let ajusteValor = parseFloat(v_ajuste_valor.value || 0);
  let ajustePct = parseFloat(v_ajuste_pct.value || 0);

  total += ajusteValor;
  total += total * (ajustePct/100);

  v_total.innerText = total.toFixed(2);
}

v_ajuste_valor.oninput = renderVenda;
v_ajuste_pct.oninput = renderVenda;

function finalizarVenda(){
  let vendas = JSON.parse(localStorage.getItem("vendas")||"[]");

  vendas.push({
    data:new Date().toLocaleString(),
    itens:vendaItens,
    total:parseFloat(v_total.innerText)
  });

  localStorage.setItem("vendas",JSON.stringify(vendas));
  vendaItens=[];
  renderVenda();
  carregarHistoricos();
}

function addCompra(){
  let compras = JSON.parse(localStorage.getItem("compras")||"[]");

  compras.push({
    produto:c_nome.value,
    qtd:c_qtd.value,
    unidade:c_unidade.value,
    preco:c_preco.value,
    data:new Date().toLocaleString(),
    total:c_qtd.value*c_preco.value
  });

  localStorage.setItem("compras",JSON.stringify(compras));
  carregarHistoricos();
}

function carregarHistoricos(){
  let vendas = JSON.parse(localStorage.getItem("vendas")||"[]");
  let compras = JSON.parse(localStorage.getItem("compras")||"[]");

  hist_vendas.innerHTML="";
  let totalMesV=0;
  vendas.forEach(v=>{
    hist_vendas.innerHTML+=`<p>${v.data} — R$ ${v.total}</p>`;
    totalMesV+=v.total;
  });
  hist_vendas.innerHTML+=`<strong>Total mês: R$ ${totalMesV.toFixed(2)}</strong>`;

  hist_compras.innerHTML="";
  let totalMesC=0;
  compras.forEach(c=>{
    hist_compras.innerHTML+=`<p>${c.data} — ${c.produto} — R$ ${c.total}</p>`;
    totalMesC+=c.total;
  });
  hist_compras.innerHTML+=`<strong>Gastos mês: R$ ${totalMesC.toFixed(2)}</strong>`;
}

carregarHistoricos();
</script>

</body>
</html>
