<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Nexus</title>

<style>
body{font-family:Arial;background:#111;color:#eee;padding:20px}
h1,h2,h3{color:#4CAF50}
.tabs button{
background:#222;color:#eee;border:none;padding:10px 15px;
cursor:pointer;margin-right:5px;border-radius:5px
}
.tabs button.active{background:#4CAF50;color:#000}
section{display:none;border:1px solid #333;padding:15px;margin-top:15px;border-radius:8px}
input,select,button{margin:5px;padding:6px}
table{width:100%;border-collapse:collapse;margin-top:10px}
th,td{border:1px solid #333;padding:6px;text-align:center}
.total{font-size:18px;color:#0f0;margin-top:10px}
.remove{color:red;cursor:pointer}
</style>

</head>
<body>

<h1>Nexus</h1>

<div class="tabs">
<button onclick="openTab('vendas')" class="active">Vendas</button>
<button onclick="openTab('compras')">Compras</button>
<button onclick="openTab('histVendas')">Histórico Vendas</button>
<button onclick="openTab('histCompras')">Histórico Compras</button>
<button onclick="openTab('resumo')">Resumo Mensal</button>
</div>

<!-- VENDAS -->
<section id="vendas" style="display:block">
<h2>Venda — Múltiplos Produtos</h2>

<input id="itemNome" placeholder="Produto">
<input id="itemQtd" type="number" step="0.01" placeholder="Quantidade">
<select id="itemUnidade">
<option>unidade</option>
<option>kg</option>
<option>litro</option>
</select>
<input id="itemPreco" type="number" step="0.01" placeholder="Preço unitário">
<button onclick="addItem()">+ Adicionar</button>

<h3>Itens do pedido</h3>
<table>
<thead>
<tr><th>Produto</th><th>Qtd</th><th>Unid</th><th>Preço</th><th>Total</th><th></th></tr>
</thead>
<tbody id="itens"></tbody>
</table>

<h3>Ajustes</h3>
<input id="ajusteValor" type="number" placeholder="Ajuste R$">
<input id="ajustePorc" type="number" placeholder="Ajuste %">

<p class="total">Total: R$ <span id="totalVenda">0.00</span></p>
<button onclick="finalizarVenda()">Finalizar Venda</button>
</section>

<!-- COMPRAS -->
<section id="compras">
<h2>Compra / Fornecedor</h2>
<input id="compraNome" placeholder="Produto">
<input id="compraQtd" type="number" step="0.01" placeholder="Quantidade">
<input id="compraPreco" type="number" step="0.01" placeholder="Preço unitário">
<button onclick="addCompra()">Registrar Compra</button>
</section>

<!-- HISTÓRICO VENDAS -->
<section id="histVendas">
<h2>Histórico de Vendas</h2>
<div id="listaVendas"></div>
</section>

<!-- HISTÓRICO COMPRAS -->
<section id="histCompras">
<h2>Histórico de Compras</h2>
<div id="listaCompras"></div>
</section>

<!-- RESUMO -->
<section id="resumo">
<h2>Resumo Mensal</h2>
<p>Total vendido no mês: R$ <span id="mesVendas">0.00</span></p>
<p>Total gasto no mês: R$ <span id="mesCompras">0.00</span></p>
</section>

<script>
let itensVenda=[];
let vendas=JSON.parse(localStorage.getItem("vendas")||"[]");
let compras=JSON.parse(localStorage.getItem("compras")||"[]");

function openTab(id){
document.querySelectorAll("section").forEach(s=>s.style.display="none");
document.querySelectorAll(".tabs button").forEach(b=>b.classList.remove("active"));
document.getElementById(id).style.display="block";
event.target.classList.add("active");
}

function addItem(){
let n=itemNome.value;
let q=parseFloat(itemQtd.value);
let u=itemUnidade.value;
let p=parseFloat(itemPreco.value);
if(!n||!q||!p)return alert("Preencha tudo");
itensVenda.push({n,q,u,p});
itemNome.value=itemQtd.value=itemPreco.value="";
renderItens();
}

function removerItem(i){
itensVenda.splice(i,1);
renderItens();
}

function renderItens(){
itens.innerHTML="";
let total=0;
if(itensVenda.length===0){
itens.innerHTML="<tr><td colspan='6'>Nenhum item</td></tr>";
}
itensVenda.forEach((i,idx)=>{
let sub=i.q*i.p;
total+=sub;
itens.innerHTML+=`
<tr>
<td>${i.n}</td>
<td>${i.q}</td>
<td>${i.u}</td>
<td>R$ ${i.p.toFixed(2)}</td>
<td>R$ ${sub.toFixed(2)}</td>
<td class="remove" onclick="removerItem(${idx})">X</td>
</tr>`;
});
let av=parseFloat(ajusteValor.value)||0;
let ap=parseFloat(ajustePorc.value)||0;
total+=av;
total+=total*(ap/100);
totalVenda.innerText=total.toFixed(2);
}

["ajusteValor","ajustePorc"].forEach(id=>{
document.getElementById(id).oninput=renderItens;
});

function finalizarVenda(){
if(itensVenda.length===0)return alert("Sem itens");
vendas.push({data:new Date().toISOString(),total:parseFloat(totalVenda.innerText)});
localStorage.setItem("vendas",JSON.stringify(vendas));
itensVenda=[];
renderItens();
renderHistoricos();
}

function addCompra(){
let n=compraNome.value;
let q=parseFloat(compraQtd.value);
let p=parseFloat(compraPreco.value);
if(!n||!q||!p)return;
compras.push({data:new Date().toISOString(),total:q*p,n});
localStorage.setItem("compras",JSON.stringify(compras));
renderHistoricos();
}

function renderHistoricos(){
listaVendas.innerHTML="";
listaCompras.innerHTML="";
let m=new Date().getMonth(),y=new Date().getFullYear();
let tv=0,tc=0;

vendas.forEach(v=>{
let d=new Date(v.data);
listaVendas.innerHTML+=`${d.toLocaleString()} — R$ ${v.total.toFixed(2)}<br>`;
if(d.getMonth()==m&&d.getFullYear()==y)tv+=v.total;
});
compras.forEach(c=>{
let d=new Date(c.data);
listaCompras.innerHTML+=`${d.toLocaleString()} — ${c.n} — R$ ${c.total.toFixed(2)}<br>`;
if(d.getMonth()==m&&d.getFullYear()==y)tc+=c.total;
});
mesVendas.innerText=tv.toFixed(2);
mesCompras.innerText=tc.toFixed(2);
}

renderItens();
renderHistoricos();
</script>

</body>
</html>
