<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Nexus</title>

<style>
body{
    margin:0;
    font-family:Arial, sans-serif;
    background:#000;
    color:#fff;
}
.tabs{
    display:flex;
    gap:8px;
    padding:10px;
}
.tab{
    flex:1;
    background:#111;
    padding:10px;
    text-align:center;
    border-radius:8px;
    cursor:pointer;
}
.tab.active{
    background:#1db954;
    color:#000;
}
.section{
    display:none;
    padding:15px;
}
.section.active{display:block;}

input,button{
    width:100%;
    padding:10px;
    margin-top:8px;
    border-radius:6px;
    border:none;
}
button{
    background:#1db954;
    font-weight:bold;
}
.item{
    background:#111;
    padding:10px;
    border-radius:6px;
    margin-top:8px;
}
.delete{
    background:#b00020;
    margin-top:5px;
}
.copy{
    background:#444;
    margin-top:5px;
}
.total{
    margin-top:15px;
    font-weight:bold;
    text-align:right;
}
</style>
</head>

<body>

<div class="tabs">
    <div class="tab active" onclick="openTab('vendas')">Vendas</div>
    <div class="tab" onclick="openTab('compras')">Fornecedores</div>
    <div class="tab" onclick="openTab('histV')">Hist. Vendas</div>
    <div class="tab" onclick="openTab('histC')">Hist. Compras</div>
</div>

<!-- VENDAS -->
<div id="vendas" class="section active">
    <input id="cliente" placeholder="Nome do cliente">
    <input id="prodV" placeholder="Produto">
    <input id="qtdV" type="number" placeholder="Quantidade">
    <input id="precoV" type="number" placeholder="Preço unitário">
    <button onclick="addItemVenda()">Adicionar produto</button>
    <div id="listaVenda"></div>
    <div class="total" id="totalVenda"></div>
    <button onclick="finalizarVenda()">Finalizar venda</button>
</div>

<!-- COMPRAS -->
<div id="compras" class="section">
    <input id="fornecedor" placeholder="Nome do fornecedor">
    <input id="prodC" placeholder="Produto">
    <input id="qtdC" type="number" placeholder="Quantidade">
    <input id="precoC" type="number" placeholder="Preço unitário">
    <button onclick="addItemCompra()">Adicionar produto</button>
    <div id="listaCompra"></div>
    <div class="total" id="totalCompra"></div>
    <button onclick="finalizarCompra()">Finalizar compra</button>
</div>

<!-- HISTÓRICO -->
<div id="histV" class="section"></div>
<div id="histC" class="section"></div>

<script>
let vendaAtual=[], compraAtual=[];
let histVendas=[], histCompras=[];

function openTab(id){
    document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));
    document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
    document.getElementById(id).classList.add('active');
    event.target.classList.add('active');
}

/* VENDAS */
function addItemVenda(){
    let p=prodV.value, q=+qtdV.value, pr=+precoV.value;
    if(!p||!q||!pr) return;
    vendaAtual.push({p,q,pr});
    renderVendaTemp();
    prodV.value=qtdV.value=precoV.value='';
}
function renderVendaTemp(){
    let total=0;
    listaVenda.innerHTML=vendaAtual.map(i=>{
        total+=i.q*i.pr;
        return `${i.p} — ${i.q} x ${i.pr}`;
    }).join('<br>');
    totalVenda.innerText=`Total: R$ ${total.toFixed(2)}`;
}
function finalizarVenda(){
    if(!vendaAtual.length) return;
    histVendas.push({
        cliente:cliente.value,
        itens:[...vendaAtual],
        total:vendaAtual.reduce((s,i)=>s+i.q*i.pr,0),
        data:new Date()
    });
    vendaAtual=[]; cliente.value='';
    listaVenda.innerHTML=''; totalVenda.innerText='';
    renderHistoricos();
}

/* COMPRAS */
function addItemCompra(){
    let p=prodC.value, q=+qtdC.value, pr=+precoC.value;
    if(!p||!q||!pr) return;
    compraAtual.push({p,q,pr});
    renderCompraTemp();
    prodC.value=qtdC.value=precoC.value='';
}
function renderCompraTemp(){
    let total=0;
    listaCompra.innerHTML=compraAtual.map(i=>{
        total+=i.q*i.pr;
        return `${i.p} — ${i.q} x ${i.pr}`;
    }).join('<br>');
    totalCompra.innerText=`Total: R$ ${total.toFixed(2)}`;
}
function finalizarCompra(){
    if(!compraAtual.length) return;
    histCompras.push({
        fornecedor:fornecedor.value,
        itens:[...compraAtual],
        total:compraAtual.reduce((s,i)=>s+i.q*i.pr,0),
        data:new Date()
    });
    compraAtual=[]; fornecedor.value='';
    listaCompra.innerHTML=''; totalCompra.innerText='';
    renderHistoricos();
}

/* HISTÓRICOS + COPIAR */
function copiarTexto(texto){
    navigator.clipboard.writeText(texto);
    alert('Copiado!');
}

function renderHistoricos(){
    let tv=0, tc=0;

    histV.innerHTML=histVendas.map((v,i)=>{
        tv+=v.total;
        let txt=`Venda - ${v.cliente}\n${v.data.toLocaleString()}\n`+
        v.itens.map(it=>`${it.p} ${it.q}x${it.pr}`).join('\n')+
        `\nTotal: R$ ${v.total}`;
        return `<div class="item">
        ${v.cliente} | R$ ${v.total.toFixed(2)}
        <button class="copy" onclick="copiarTexto(\`${txt}\`)">Copiar</button>
        <button class="delete" onclick="histVendas.splice(${i},1);renderHistoricos()">Excluir</button>
        </div>`;
    }).join('')+`<div class="total">Total do mês: R$ ${tv.toFixed(2)}</div>`;

    histC.innerHTML=histCompras.map((c,i)=>{
        tc+=c.total;
        let txt=`Compra - ${c.fornecedor}\n${c.data.toLocaleString()}\n`+
        c.itens.map(it=>`${it.p} ${it.q}x${it.pr}`).join('\n')+
        `\nTotal: R$ ${c.total}`;
        return `<div class="item">
        ${c.fornecedor} | R$ ${c.total.toFixed(2)}
        <button class="copy" onclick="copiarTexto(\`${txt}\`)">Copiar</button>
        <button class="delete" onclick="histCompras.splice(${i},1);renderHistoricos()">Excluir</button>
        </div>`;
    }).join('')+`<div class="total">Total do mês: R$ ${tc.toFixed(2)}</div>`;
}
</script>

</body>
</html>
